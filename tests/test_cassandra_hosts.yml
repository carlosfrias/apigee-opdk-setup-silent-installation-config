---
- hosts: '{{ hosts }}'
  remote_user: root
  roles:
    - opdk-setup-default-settings

  tasks:
#  - setup:
#  - ec2_facts:

  - name: Configure cassandra hosts
    cassandra_hosts:
      inventory_hostname: '{{ inventory_hostname }}'
      hostvars: '{{ hostvars }}'
      public_ip_field_name: 'ec2_ip_address'
      private_ip_field_name: 'ec2_private_ip_address'

  - name: get debug file
    become: yes
    fetch:
      src: ~/cass_host_file.json
      dest: hostvars

  - debug: var=cassandra_hosts
